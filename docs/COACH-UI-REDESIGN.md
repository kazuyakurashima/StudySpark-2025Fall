# 指導者画面 UI/UX 再設計計画

## 概要

指導者（コーチ）画面のナビゲーション多重化・機能重複を解消し、シンプルで迷わないUXを実現する。

---

## 現状の問題

### ナビゲーションの多重化
- UserProfileHeader（トップ）
- 生徒詳細のタブナビ（6タブ）
- クイックアクション（タブと重複）
- ボトムナビ（4項目）

### 機能の重複
| 機能 | ボトムナビ | 生徒詳細タブ | クイックアクション |
|------|-----------|-------------|-------------------|
| 目標 | ✅ | ✅ | ✅ |
| 応援 | ✅ | ✅ | ✅ |
| 分析 | ✅ | ✅ | ✅ |

→ 同じ機能が3箇所に存在し、ユーザーが迷う

---

## 設計原則

### 主要タスク（優先度順）
1. **毎日**: 生徒の学習記録を確認し、応援メッセージを送る
2. **毎日**: 問題のある生徒（未入力等）を早期発見
3. **週次**: 生徒の目標達成度を確認
4. **随時**: 特定生徒の詳細な分析を見る

### 理想的なユーザーフロー
```
ホーム（ダッシュボード）
    ↓
  生徒カードをタップ
    ↓
生徒詳細ページ（すべての情報と操作がここで完結）
    ↓
  戻るボタン
    ↓
ホーム
```

### 必須条件
- **応援送信**: 1タップ以内で到達可能
- **未入力検知**: ホームのファーストビューで確認可能
- **戻り導線**: 常に上部に固定（←）+ スワイプバック対応

---

## 短期実装計画（優先度: 高）

### 1. 生徒詳細ページ

#### 変更内容
- [ ] タブを6→3に削減: **概要 | 学習 | 応援**
- [ ] クイックアクション廃止
- [ ] ボトムナビ非表示（フルスクリーン体験）
- [ ] ヘッダーをシンプル化: `← 田中太郎 小6・Aコース`

#### 概要タブの情報階層
```
1. サマリーカード（4つ）
   - 連続日数
   - 今週の学習日
   - 正答率
   - 問題数

2. 最近の学習（3件程度）
   - 科目・正答率・時間
   - 応援ボタン（未応援の場合）

3. 目標セクション
   - 次のテスト目標
   - 達成状況

4. 簡易分析セクション
   - 科目別正答率グラフ（コンパクト）
```

#### ワイヤーフレーム
```
┌────────────────────────────────────┐
│  ← 田中太郎  小6・Aコース          │
├────────────────────────────────────┤
│                                    │
│   ┌──────┬──────┬──────┬──────┐   │
│   │連続3日│今週4日│正答85%│120問│   │
│   └──────┴──────┴──────┴──────┘   │
│                                    │
│   ──── 概要 | 学習 | 応援 ────     │
│                                    │
│   最近の学習                        │
│   ─────────────────────────────    │
│   算数 85% · 2時間前    [応援]     │
│   国語 72% · 昨日       ✓済       │
│                                    │
│   目標                              │
│   ─────────────────────────────    │
│   合不合テスト 第3回: Bコース希望   │
│   現在の予測: Bコース 到達可能      │
│                                    │
│   分析                              │
│   ─────────────────────────────    │
│   [科目別正答率グラフ]              │
│                                    │
└────────────────────────────────────┘
（ボトムナビなし）
```

### 2. ホーム画面

#### 変更内容
- [ ] ファーストビューに「要対応/応援待ち」カード固定
- [ ] 担当生徒一覧（ステータスドット付き）
- [ ] 最近の学習（5件、応援待ち優先）

#### ワイヤーフレーム
```
┌────────────────────────────────────┐
│  ダッシュボード              [更新] │
├────────────────────────────────────┤
│                                    │
│  ⚠️ 3名の生徒が7日以上未入力       │  ← アラート（常時表示）
│  [田中] [佐藤] [鈴木]              │
│                                    │
│  担当生徒                    5名   │
│  ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐ │
│  │😊🟢│ │😊🟡│ │😊🔴│ │😊🟢│ │😊🟢│ │
│  │田中│ │佐藤│ │鈴木│ │高橋│ │伊藤│ │
│  └───┘ └───┘ └───┘ └───┘ └───┘ │
│                                    │
│  最近の学習              すべて見る→│
│  ─────────────────────────────    │
│  田中 算数 85% 2時間前     [応援]  │
│  佐藤 国語 72% 5時間前     [応援]  │
│  高橋 理科 90% 昨日        ✓済    │
│                                    │
└────────────────────────────────────┘
┌─────────────┬─────────────┬─────────┐
│   🏠 ホーム  │  💬 応援   │ ⚙️ 設定 │  ← ボトムナビ3項目
└─────────────┴─────────────┴─────────┘
```

### 3. ボトムナビゲーション

#### 変更内容
- [ ] 4項目 → 3項目に削減
- [ ] `ホーム | 応援 | 設定`
- [ ] 「ゴールナビ」「分析」は削除（生徒詳細に統合）

#### 役割の明確化
| タブ | 役割 |
|------|------|
| ホーム | 全体俯瞰・生徒一覧・アラート |
| 応援 | 全生徒の応援待ちリスト（横断的タスク管理） |
| 設定 | プロフィール・アカウント設定 |

---

## デザイントークン

### 色彩
```css
/* 背景 */
--bg-page: #f8fafc;        /* slate-50 */
--bg-card: #ffffff;

/* テキスト */
--text-primary: #0f172a;   /* slate-900 */
--text-secondary: #64748b; /* slate-500 */
--text-muted: #94a3b8;     /* slate-400 */

/* アクセント */
--accent-primary: #3b82f6; /* blue-500（ブランドカラー） */

/* ステータス */
--status-good: #10b981;    /* emerald-500 */
--status-warning: #f59e0b; /* amber-500 */
--status-alert: #ef4444;   /* red-500 */
```

### カードスタイル
```css
.card {
  background: var(--bg-card);
  border: none;
  border-radius: 1rem;      /* rounded-2xl */
  box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); /* shadow-sm */
}

.card:hover {
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); /* shadow-md */
}
```

### スペーシング
```css
--spacing-section: 2rem;   /* space-y-8 */
--spacing-card: 1rem;      /* gap-4 */
--spacing-content: 1rem;   /* p-4 */
```

---

## 中期実装計画（優先度: 中）

### 1. 応援ページのUI刷新
- [ ] カードレイアウト統一
- [ ] 同時記録バッジ対応
- [ ] フィルタUIの改善

### 2. 縦長スクロール対応
- [ ] 見出し固定（sticky header）
- [ ] 「トップへ戻る」ボタン
- [ ] セクション間のナビゲーション

### 3. デザインシステム化
- [ ] アイコン一覧の整理
- [ ] タイポグラフィスケールの定義
- [ ] コンポーネントライブラリ化

---

## リスク対策

### 導線確保
- 「応援待ち」「要対応」はホーム上部に常時表示
- ボトムナビ「応援」タブで全体横断ビューを確保

### 受け入れテスト項目
- [ ] 応援送信が1タップ以内で到達可能か
- [ ] 未入力検知がファーストビューで確認可能か
- [ ] 生徒詳細からホームへの戻りがスムーズか
- [ ] スワイプバックが機能するか

---

## 実装順序

### Phase 1（短期） ✅ 完了
1. ✅ 生徒詳細: タブ削減・クイックアクション廃止
2. ✅ 生徒詳細: ボトムナビ非表示
3. ✅ 生徒詳細: 概要タブの情報階層再設計
4. ✅ ボトムナビ: 3項目に削減
5. ✅ ホーム: アラートをファーストビューに固定（前回実装済み）

### Phase 1.5（ナビゲーション最適化） 🔄 進行中

#### 背景分析

現状の3項目ボトムナビ（ホーム/応援/設定）には以下の問題がある：

| 問題 | 詳細 |
|------|------|
| 設定の頻度不一致 | 月1回程度の低頻度アクションがボトムナビの一等地を占有 |
| 一般パターンからの逸脱 | Gmail, Slack, LINE等の主要アプリは設定をアバターメニューに配置 |
| 横断機能の不足 | 「全体を俯瞰する」ニーズ（分析/比較）への導線がない |

#### 設計原則（UI/UXベストプラクティス）

1. **ボトムナビは「毎日タップする行動」に限定**
   - 週1回以下のアクションはボトムに置かない
   - 3項目が最適（2項目は珍しい、4項目以上は認知負荷増）

2. **設定は個人設定 → アバターメニューが自然**
   - ユーザーの期待に沿ったメンタルモデル
   - 「自分のアイコン = 自分の設定」という直感

3. **詳細ページは没入体験を優先**
   - ボトムナビ非表示で集中を促す
   - 戻る導線は上部に固定（←ボタン + スワイプバック）

4. **横断タスク vs 個別深掘りの分離**
   - ボトムナビ: 横断タスクの入口
   - カード→詳細: 個別生徒への深掘り

#### 改善案：ボトムナビ3項目（推奨）

```
┌────────────────────────────────────────┐
│  [Avatar▼] ダッシュボード        [🔄]  │
├────────────────────────────────────────┤
│                                        │
│  ⚠️ 3名の生徒が応援待ち               │
│  [田中] [佐藤] [鈴木]                  │
│                                        │
│  担当生徒              [5年] [6年]     │  ← 学年フィルタはページ内
│  ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐       │
│  │😊🟢│ │😊🟡│ │😊🔴│ │😊🟢│ │😊🟢│       │
│  └───┘ └───┘ └───┘ └───┘ └───┘       │
│                                        │
└────────────────────────────────────────┘
┌────────────┬────────────┬──────────────┐
│  🏠 ホーム │  💬 応援  │  📊 分析    │  ← 3項目
└────────────┴────────────┴──────────────┘
```

**アバターメニュー内容:**
```
┌─────────────────────┐
│  田中コーチ         │
│  coach@example.com  │
├─────────────────────┤
│  ⚙️ 設定           │
│  📤 ログアウト      │
└─────────────────────┘
```

#### 各タブの役割

| タブ | 役割 | 頻度 | 応援タブとの差別化 |
|------|------|------|-------------------|
| ホーム | 生徒一覧 + アラート + 応援待ちサマリー | 毎日 | - |
| 応援 | 全生徒横断の応援待ちリスト（個別対応） | 毎日 | アクション実行の場 |
| 分析 | 全体傾向・生徒間比較・週次レポート | 週数回 | 俯瞰・比較の場（アクションなし） |

**分析タブと応援タブの役割差別化:**
- **応援タブ**: 「今すぐ対応が必要な生徒」へのアクション実行（応援メッセージ送信）
- **分析タブ**: 「全体の傾向を把握する」ための俯瞰ビュー（週次サマリー、生徒間比較、科目別傾向）
- 重複を避けるため、分析タブでは応援送信UIを持たない

#### 学年フィルタの仕様

| 項目 | 仕様 |
|------|------|
| デフォルト | 「全員」（初回訪問時） |
| 状態保持 | セッション中は前回選択を保持（localStorage） |
| フィードバック | 選択時にボタンがアクティブ状態に変化 + 件数表示更新 |
| UI配置 | 担当生徒セクションのヘッダー右側 |

```
担当生徒 (12名)              [全員] [5年] [6年]
                                    ↑ アクティブ時は背景色変化
```

#### アバターメニューの仕様

| 項目 | 仕様 |
|------|------|
| タップ領域 | 44x44px以上（モバイルアクセシビリティ基準） |
| 閉じる方法 | メニュー外タップ / ESCキー |
| 含めるアクション | プロフィール表示、設定、ログアウト |
| 位置 | ヘッダー左側（アバター + 名前） |

**メニュー内容:**
```
┌─────────────────────┐
│  👤 田中コーチ      │
│  coach@example.com  │
├─────────────────────┤
│  ⚙️ 設定           │
│  ❓ ヘルプ          │  ← 低頻度アクションをまとめる
│  📤 ログアウト      │
└─────────────────────┘
```

#### ボトムナビのラベル表示ルール

- **必須**: アイコン + ラベルを常に表示（アイコンのみは避ける）
- **フォントサイズ**: 10-12px（読みやすさ確保）
- **アクティブ状態**: 色変化 + 太字で明示

#### 代替案：ボトムナビ2項目

分析機能の利用頻度が低い場合：

```
┌──────────────────┬──────────────────┐
│    🏠 ホーム     │     💬 応援     │
└──────────────────┴──────────────────┘
```

- 分析はホーム内カードまたはアバターメニューから遷移
- 2項目はデザイン的に目立たせる工夫が必要（アイコン大きめ、背景強調等）

#### 実装タスク

- [x] 設定をアバターメニューに統合
  - [x] UserProfileHeaderに設定リンクを追加（コーチのみ）
  - [x] 既存のドロップダウンUIを活用
  - [x] ホーム・応援・分析ページのヘッダーに配置済み
- [x] ボトムナビを3項目に変更
  - [x] ホーム/応援/分析 の3項目構成
  - [x] アイコン + ラベル表示を維持
- [ ] ホーム画面の学年フィルタ（Phase 2へ延期）
  - [ ] ページ内プリセットボタン（全員/5年/6年）
  - [ ] localStorage で選択状態を保持
  - [ ] 選択時のフィードバック（アクティブ状態 + 件数更新）
- [x] 設定ページの導線確認
  - [x] アバターメニューからの遷移可能

### Phase 2（中期）
6. 応援ページ: UI刷新
7. 全体: デザイントークン適用
8. 全体: スクロール体験の改善

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2024-12-08 | 初版作成 |
| 2025-12-08 | Phase 1 完了（タブ削減、クイックアクション廃止、ボトムナビ統合） |
| 2025-12-08 | Phase 1.5 計画追加（設定→アバターメニュー統合、ボトムナビ最適化） |
| 2025-12-08 | Phase 1.5 実装完了（ボトムナビ3項目: ホーム/応援/分析、設定→アバター） |
