# T-006: 指導者の生徒管理機能

**Based on:** US-003 指導者の生徒管理  
**Priority:** Should Have  
**User Story:** 指導者が複数生徒の学習状況を一覧管理し、効率的な指導計画を立てられる  
**Assignee:** -  
**Status:** Planning

## 概要

指導者（コーチ）が担当クラスの全生徒の学習状況を管理し、個別指導に役立てる機能を実装する。

## 要件

### AC基準
- **AC-005:** WHEN 指導者がログイン THEN 全生徒リストが表示される
- **AC-006:** WHEN 生徒選択 THEN 個別の学習詳細が確認できる
- **AC-007:** WHEN クラス管理 THEN 生徒の追加・削除が可能
- **AC-008:** WHEN 進捗分析 THEN クラス全体の統計が表示される

### 機能詳細
- 担当クラスの生徒一覧表示
- 個別生徒の学習記録閲覧
- クラス全体の進捗統計
- 生徒の目標設定支援
- 学習パフォーマンス分析

## 技術仕様

### API Endpoints
- `GET /api/classes/my-classes` - 担当クラス一覧取得
- `GET /api/classes/:id/students` - クラス内生徒一覧
- `GET /api/students/:id/progress` - 生徒個別進捗
- `POST /api/classes/:id/students` - 生徒をクラスに追加
- `DELETE /api/classes/:id/students/:student_id` - 生徒をクラスから削除
- `GET /api/classes/:id/analytics` - クラス統計分析

### Database Tables
- `classes` - クラス情報
- `class_memberships` - クラス所属関係
- `profiles` - 生徒プロフィール（閲覧）
- `learning_records` - 生徒の学習記録（閲覧）
- `goals` - 生徒の目標（閲覧・編集支援）

### UI Routes
- `/coach` - 指導者ダッシュボード
- `/coach/spark` - 生徒学習状況管理
- `/coach/reflect` - 生徒個別分析
- `/coach/goal` - 生徒目標設定支援

## ToDo

### バックエンド実装
- [x] classesテーブル設計・作成
- [x] class_membershipsテーブル設計・作成
- [x] 指導者用RLSポリシー
- [ ] クラス管理CRUD API
- [ ] 生徒進捗統計API
- [ ] クラス分析ダッシュボードAPI
- [ ] 生徒招待機能API

### フロントエンド実装
- [ ] 指導者ダッシュボード
  - [ ] 担当クラス一覧
  - [ ] クラス全体サマリー
  - [ ] 注意が必要な生徒のハイライト
  - [ ] 最新の活動状況
- [ ] 生徒管理画面
  - [ ] 生徒一覧（タブ形式）
  - [ ] 生徒詳細モーダル
  - [ ] 学習記録の一覧表示
  - [ ] 進捗チャート
- [ ] クラス分析画面
  - [ ] 科目別平均理解度
  - [ ] 学習頻度分析
  - [ ] 目標達成率統計
  - [ ] 学習トレンド分析
- [ ] 生徒招待・管理
  - [ ] 招待コード生成
  - [ ] 生徒登録承認
  - [ ] クラス移動機能

### 分析・レポート機能
- [ ] 個別生徒レポート生成
- [ ] クラス全体レポート
- [ ] 期間指定分析
- [ ] データエクスポート機能

## 受入テスト

### テストケース
1. **クラス管理テスト**
   - [ ] 担当クラス一覧の正確表示
   - [ ] 生徒一覧の表示
   - [ ] 生徒追加・削除機能
   - [ ] 権限制御（他のクラスアクセス不可）

2. **生徒管理テスト**
   - [ ] 個別生徒詳細表示
   - [ ] 学習記録の正確な表示
   - [ ] 進捗チャートの表示
   - [ ] データの最新性確保

3. **分析機能テスト**
   - [ ] クラス統計の正確性
   - [ ] 期間指定分析
   - [ ] レポート生成
   - [ ] データエクスポート

## 定義完了（DoD）

- [ ] 全受入テスト通過
- [ ] セキュリティレビュー完了（生徒データ保護）
- [ ] パフォーマンステスト（ダッシュボード < 3秒）
- [ ] モバイル対応確認
- [ ] データプライバシー要件確認
- [ ] 単体テスト作成

## UI/UX考慮事項

- 大量の生徒データの効率的表示
- 直感的な分析チャート・グラフ
- 注意が必要な生徒の視覚的ハイライト
- レスポンシブ対応（タブレット最適化）

## セキュリティ・プライバシー

- 生徒データへの適切なアクセス制御
- 担当クラスのみアクセス可能
- 生徒の個人情報保護
- データ閲覧ログの記録

## 関連チケット

- T-003: 認証システム実装（依存）
- T-004: 学生の学習記録機能（依存）
- T-007: クラス管理システム
- T-011: 分析・レポート機能

## 将来の拡張

- 保護者とのコミュニケーション機能
- 個別指導計画作成支援
- AI による学習提案機能
- 他の指導者との連携機能

## 備考

- 指導者は複数のクラスを担当可能
- 生徒データは読み取り専用（学習記録は編集不可）
- 目標設定は生徒との協議で支援のみ
