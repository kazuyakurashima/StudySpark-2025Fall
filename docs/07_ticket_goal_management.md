# T-007: 目標設定機能

**Based on:** US-004 目標設定  
**Priority:** Must Have  
**User Story:** 学生がテスト目標を設定し、計画的に学習を進められる  
**Assignee:** -  
**Status:** Planning

## 概要

学生がテスト目標（コース・組・科目別スコア）を設定し、達成状況を自動評価する機能を実装する。

## 要件

### AC基準
- **AC-007:** WHEN テスト目標設定 THEN コース・組・科目別スコアが登録される
- **AC-008:** WHEN 目標期日到達 THEN 達成状況が自動評価される
- **AC-009:** WHEN 目標表示 THEN 次回テストまでの日数が表示される
- **AC-010:** WHEN 目標編集 THEN テスト実施7日前まで変更可能

### 機能詳細
- テストスケジュール表示
- 目標設定（コース: S/A/B/C、組: 数値、科目別スコア）
- 目標に対する思い・コメント入力
- 達成状況の自動評価
- 目標履歴管理

## 技術仕様

### API Endpoints
- `GET /api/test-schedules` - テストスケジュール取得
- `POST /api/goals` - 目標設定
- `PUT /api/goals/:id` - 目標更新
- `GET /api/goals/my-goals` - 自分の目標一覧
- `GET /api/goals/:id/progress` - 目標達成状況

### Database Tables
- `test_schedules` - テストスケジュール
- `goals` - 目標設定
- `goal_results` - 目標結果（将来の拡張）

### UI Routes
- `/student/goal` - 学生目標設定画面
- `/parent/goal` - 保護者目標確認画面
- `/coach/goal` - 指導者目標支援画面

## ToDo

### バックエンド実装
- [x] test_schedulesテーブル作成
- [x] goalsテーブル作成
- [x] テストデータ投入
- [ ] 目標設定CRUD API
- [ ] テストスケジュール管理API
- [ ] 達成状況評価ロジック
- [ ] 目標期限チェック機能

### フロントエンド実装
- [ ] テストスケジュール表示
  - [ ] 次回テスト情報カード
  - [ ] 残り日数カウントダウン
  - [ ] テスト種別の表示
- [ ] 目標設定フォーム
  - [ ] コース選択（S/A/B/C）
  - [ ] 組選択（数値入力）
  - [ ] 科目別スコア設定
  - [ ] 目標への思い入力欄
  - [ ] 保存・更新機能
- [ ] 目標確認画面
  - [ ] 設定済み目標表示
  - [ ] 達成状況の視覚化
  - [ ] 過去の目標履歴
- [ ] 週間目標カード（ダッシュボード）
  - [ ] コンパクトな目標表示
  - [ ] 進捗インジケーター
  - [ ] クイック編集機能

### データ管理
- [ ] テストスケジュールの管理機能
- [ ] 定期的な目標評価バッチ
- [ ] 目標達成通知
- [ ] 目標統計レポート

## 受入テスト

### テストケース
1. **目標設定テスト**
   - [ ] 合不合判定テスト目標（コース・組）設定
   - [ ] 週テスト目標（科目別スコア）設定
   - [ ] 思い・コメント入力と保存
   - [ ] 設定期限の制御（7日前まで）

2. **目標表示テスト**
   - [ ] 次回テストまでの日数表示
   - [ ] 設定済み目標の正確表示
   - [ ] 達成状況の視覚化
   - [ ] 目標履歴の表示

3. **権限・制御テスト**
   - [ ] 自分の目標のみ編集可能
   - [ ] 保護者による目標閲覧
   - [ ] 期限切れ目標の編集不可
   - [ ] テスト終了後の目標ロック

## 定義完了（DoD）

- [ ] 全受入テスト通過
- [ ] 目標設定のUXテスト実施
- [ ] パフォーマンステスト（目標画面表示 < 2秒）
- [ ] モバイル対応確認
- [ ] データ整合性確認
- [ ] 単体テスト作成

## UI/UX考慮事項

- 目標設定の簡易性（ドラッグ&ドロップ、スライダー活用）
- 達成状況の分かりやすい視覚化
- モチベーション向上のデザイン
- 次回テストへの意識付け

## ビジネスロジック

- 目標設定期限: テスト実施7日前まで
- 達成評価: テスト結果入力後に自動計算
- 目標種別: 合不合判定テスト（コース・組）、週テスト（科目別スコア）

## 関連チケット

- T-003: 認証システム実装（依存）
- T-004: 学生の学習記録機能（関連）
- T-005: 保護者の進捗確認機能（関連）
- T-006: 指導者の生徒管理機能（関連）
- T-013: 通知システム

## 将来の拡張

- 目標達成予測AI
- 個別最適化された目標提案
- 目標達成のための学習計画自動生成
- グループ目標・競争要素

## 備考

- テストスケジュールは管理者が事前登録
- 目標は個人情報として慎重に取り扱い
- 目標達成状況はモチベーション向上に活用
