# T-008: AIコーチ機能

**Based on:** US-005 AIコーチ機能  
**Priority:** Could Have  
**User Story:** 学生がAIコーチからフィードバックを受け、モチベーションを維持できる  
**Assignee:** -  
**Status:** Planning

## 概要

AIコーチが学生の学習状況に応じて自動的にメッセージを生成し、モチベーション維持をサポートする機能を実装する。

## 要件

### AC基準
- **AC-009:** WHEN 学生がログイン THEN 時間帯別挨拶メッセージが表示される
- **AC-010:** WHEN 連続学習日数達成 THEN 励ましメッセージが生成される
- **AC-011:** WHEN 理解度向上 THEN 称賛メッセージが表示される
- **AC-012:** WHEN 学習停滞 THEN 励ましメッセージが表示される

### 機能詳細
- 時間帯別挨拶（おはよう、こんにちは、お疲れさま）
- 連続学習日数に応じた励ましメッセージ
- 学習記録に基づく個別化メッセージ
- 定型メッセージのローテーション表示

## 技術仕様

### API Endpoints
- `GET /api/ai-coach/messages` - AIコーチメッセージ取得
- `POST /api/ai-coach/generate` - 新規メッセージ生成
- `PUT /api/ai-coach/messages/:id/read` - メッセージ既読更新

### Database Tables
- `ai_coach_messages` - AIコーチメッセージ
- `learning_streaks` - 連続学習日数（参照）
- `learning_records` - 学習記録（参照）

### UI Routes
- `/student` - ダッシュボード（メッセージ表示）
- 各画面でのコーチメッセージ表示

## ToDo

### バックエンド実装
- [x] ai_coach_messagesテーブル作成
- [ ] メッセージ生成ロジック実装
  - [ ] 時間帯別挨拶生成
  - [ ] 連続学習日数判定
  - [ ] 学習記録分析ロジック
  - [ ] 定型メッセージ管理
- [ ] メッセージ配信API
- [ ] メッセージ履歴管理
- [ ] バッチ処理（定期メッセージ生成）

### フロントエンド実装
- [ ] AIコーチメッセージUI
  - [ ] メッセージカード表示
  - [ ] アバター表示
  - [ ] アニメーション効果
  - [ ] メッセージ履歴表示
- [ ] ダッシュボード統合
  - [ ] メインメッセージ表示
  - [ ] グラデーション背景
  - [ ] レスポンシブ対応
- [ ] メッセージ管理
  - [ ] 既読・未読管理
  - [ ] メッセージ削除機能
  - [ ] 設定（メッセージ頻度調整）

### メッセージロジック
- [ ] 学習パターン分析
  - [ ] 学習頻度の判定
  - [ ] 理解度トレンド分析
  - [ ] 科目別パフォーマンス評価
- [ ] コンテキスト別メッセージ
  - [ ] 新規ユーザー向けメッセージ
  - [ ] 目標達成時のメッセージ
  - [ ] 学習復帰時のメッセージ
- [ ] パーソナライゼーション
  - [ ] ユーザー名の挿入
  - [ ] 学習履歴の参照
  - [ ] 個別化要素の追加

## 受入テスト

### テストケース
1. **メッセージ生成テスト**
   - [ ] 時間帯別メッセージの適切な生成
   - [ ] 連続学習日数によるメッセージ変化
   - [ ] 学習記録に基づくメッセージ生成
   - [ ] 定型メッセージのローテーション

2. **表示・UXテスト**
   - [ ] ダッシュボードでの適切な表示
   - [ ] メッセージの読みやすさ
   - [ ] アニメーション効果の動作
   - [ ] モバイル表示の確認

3. **パフォーマンステスト**
   - [ ] メッセージ生成速度（< 500ms）
   - [ ] 大量メッセージの処理
   - [ ] バッチ処理の効率性
   - [ ] データベース負荷の確認

## 定義完了（DoD）

- [ ] 全受入テスト通過
- [ ] UXテスト実施（学生からのフィードバック）
- [ ] パフォーマンステスト通過
- [ ] モバイル対応確認
- [ ] メッセージ内容のレビュー完了
- [ ] 単体テスト作成

## UI/UX考慮事項

- 親しみやすいAIキャラクター
- 適度な頻度でのメッセージ表示（煩わしくない）
- 学習に集中できるデザイン
- 励ましの気持ちが伝わる文言

## メッセージコンテンツ

### 時間帯別挨拶
- 朝（~10時）: 「おはようございます！今日も元気にスタートしましょう」
- 昼（10-17時）: 「こんにちは！今日の学習はいかがですか？」
- 夜（17時~）: 「お疲れさまです！今日も一日よく頑張りましたね」

### 連続学習メッセージ
- 1日: 「今日から学習スタート！」
- 3日: 「3日連続、素晴らしいです！」
- 7日: 「1週間継続、すごいです！この調子で頑張りましょう」
- 30日: 「30日達成！継続は力なりですね」

## 関連チケット

- T-003: 認証システム実装（依存）
- T-004: 学生の学習記録機能（依存）
- T-012: ダッシュボード機能
- T-013: 通知システム

## 将来の拡張

- 生成AI (ChatGPT/Claude) を活用した動的メッセージ生成
- 学習内容に基づく具体的なアドバイス
- 音声メッセージ対応
- 学習計画の提案機能

## 備考

- 初期実装は定型メッセージのローテーション
- メッセージは日本語で親しみやすい文言
- 学習の妨げにならない適度な頻度で表示